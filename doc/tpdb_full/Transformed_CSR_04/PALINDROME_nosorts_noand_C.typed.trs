(STRATEGY
    INNERMOST)

(VAR
    I P X X1 X2 Y Z)
(DATATYPES
    A = ÂµX.< mark(X), nil, tt, ok(X) >)
(SIGNATURES
    active :: [A] -> A
    __ :: [A x A] -> A
    U11 :: [A] -> A
    U12 :: [A] -> A
    isNePal :: [A] -> A
    proper :: [A] -> A
    top :: [A] -> A)
(RULES
    active(__(__(X,Y),Z)) ->
      mark(__(X,__(Y,Z)))
    active(__(X,nil())) -> mark(X)
    active(__(nil(),X)) -> mark(X)
    active(U11(tt())) ->
      mark(U12(tt()))
    active(U12(tt())) -> mark(tt())
    active(isNePal(__(I
                     ,__(P,I)))) -> mark(U11(tt()))
    active(__(X1,X2)) ->
      __(active(X1),X2)
    active(__(X1,X2)) -> __(X1
                           ,active(X2))
    active(U11(X)) -> U11(active(X))
    active(U12(X)) -> U12(active(X))
    active(isNePal(X)) ->
      isNePal(active(X))
    __(mark(X1),X2) -> mark(__(X1
                              ,X2))
    __(X1,mark(X2)) -> mark(__(X1
                              ,X2))
    U11(mark(X)) -> mark(U11(X))
    U12(mark(X)) -> mark(U12(X))
    isNePal(mark(X)) ->
      mark(isNePal(X))
    proper(__(X1,X2)) ->
      __(proper(X1),proper(X2))
    proper(nil()) -> ok(nil())
    proper(U11(X)) -> U11(proper(X))
    proper(tt()) -> ok(tt())
    proper(U12(X)) -> U12(proper(X))
    proper(isNePal(X)) ->
      isNePal(proper(X))
    __(ok(X1),ok(X2)) -> ok(__(X1
                              ,X2))
    U11(ok(X)) -> ok(U11(X))
    U12(ok(X)) -> ok(U12(X))
    isNePal(ok(X)) -> ok(isNePal(X))
    top(mark(X)) -> top(proper(X))
    top(ok(X)) -> top(active(X)))
