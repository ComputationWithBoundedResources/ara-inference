(STRATEGY
    INNERMOST)

(VAR
    I P V V1 V2 X X1 X2 Y Z)
(DATATYPES
    A = ÂµX.< mark(X), nil, tt, a, e, i, o, u, ok(X) >)
(SIGNATURES
    active :: [A] -> A
    __ :: [A x A] -> A
    and :: [A x A] -> A
    proper :: [A] -> A
    isList :: [A] -> A
    isNeList :: [A] -> A
    isQid :: [A] -> A
    isNePal :: [A] -> A
    isPal :: [A] -> A
    top :: [A] -> A)
(RULES
    active(__(__(X,Y),Z)) ->
      mark(__(X,__(Y,Z)))
    active(__(X,nil())) -> mark(X)
    active(__(nil(),X)) -> mark(X)
    active(and(tt(),X)) -> mark(X)
    active(isList(V)) ->
      mark(isNeList(V))
    active(isList(nil())) ->
      mark(tt())
    active(isList(__(V1,V2))) ->
      mark(and(isList(V1),isList(V2)))
    active(isNeList(V)) ->
      mark(isQid(V))
    active(isNeList(__(V1,V2))) ->
      mark(and(isList(V1)
              ,isNeList(V2)))
    active(isNeList(__(V1,V2))) ->
      mark(and(isNeList(V1)
              ,isList(V2)))
    active(isNePal(V)) ->
      mark(isQid(V))
    active(isNePal(__(I
                     ,__(P,I)))) -> mark(and(isQid(I)
                                            ,isPal(P)))
    active(isPal(V)) ->
      mark(isNePal(V))
    active(isPal(nil())) ->
      mark(tt())
    active(isQid(a())) -> mark(tt())
    active(isQid(e())) -> mark(tt())
    active(isQid(i())) -> mark(tt())
    active(isQid(o())) -> mark(tt())
    active(isQid(u())) -> mark(tt())
    active(__(X1,X2)) ->
      __(active(X1),X2)
    active(__(X1,X2)) -> __(X1
                           ,active(X2))
    active(and(X1,X2)) ->
      and(active(X1),X2)
    __(mark(X1),X2) -> mark(__(X1
                              ,X2))
    __(X1,mark(X2)) -> mark(__(X1
                              ,X2))
    and(mark(X1),X2) -> mark(and(X1
                                ,X2))
    proper(__(X1,X2)) ->
      __(proper(X1),proper(X2))
    proper(nil()) -> ok(nil())
    proper(and(X1,X2)) ->
      and(proper(X1),proper(X2))
    proper(tt()) -> ok(tt())
    proper(isList(X)) ->
      isList(proper(X))
    proper(isNeList(X)) ->
      isNeList(proper(X))
    proper(isQid(X)) ->
      isQid(proper(X))
    proper(isNePal(X)) ->
      isNePal(proper(X))
    proper(isPal(X)) ->
      isPal(proper(X))
    proper(a()) -> ok(a())
    proper(e()) -> ok(e())
    proper(i()) -> ok(i())
    proper(o()) -> ok(o())
    proper(u()) -> ok(u())
    __(ok(X1),ok(X2)) -> ok(__(X1
                              ,X2))
    and(ok(X1),ok(X2)) -> ok(and(X1
                                ,X2))
    isList(ok(X)) -> ok(isList(X))
    isNeList(ok(X)) ->
      ok(isNeList(X))
    isQid(ok(X)) -> ok(isQid(X))
    isNePal(ok(X)) -> ok(isNePal(X))
    isPal(ok(X)) -> ok(isPal(X))
    top(mark(X)) -> top(proper(X))
    top(ok(X)) -> top(active(X)))
